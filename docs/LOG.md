🗺️ Updated HomeView map with 0 styled routes. Unpaved drawn for: 0 routes.
🔄 Loading routes with filters
🔄 Filter - country: Australia
🔄 Client-side filter - minimum distance: 0.0
🔄 Fetching routes from Firebase...
🔍 Fetching routes with filters: Optional(["isPublic": true, "country": "Australia"])
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🎯 RouteTypeMarker: Assigned 0 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 0
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 0 styled routes. Unpaved drawn for: 0 routes.
🔄 Found 6 documents to analyze
[AuthManager] Loaded latest user data from Firebase
✅ Loaded available states: ["Canterbury", "Otago", "Tasmania", "Victoria"]
✅ Loaded available route types: ["Bikepacking", "Event", "Single"]
✅ Loaded available distance ranges: ["0-50", "200-500", "500+"]
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🎯 RouteTypeMarker: Assigned 0 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 0
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 0 styled routes. Unpaved drawn for: 0 routes.
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🎯 RouteTypeMarker: Assigned 0 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 0
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 0 styled routes. Unpaved drawn for: 0 routes.
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🎯 RouteTypeMarker: Assigned 0 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 0
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 0 styled routes. Unpaved drawn for: 0 routes.
nw_connection_copy_connected_local_endpoint_block_invoke [C7] Client called nw_connection_copy_connected_local_endpoint on unconnected nw_connection
nw_connection_copy_connected_remote_endpoint_block_invoke [C7] Client called nw_connection_copy_connected_remote_endpoint on unconnected nw_connection
nw_connection_copy_protocol_metadata_internal_block_invoke [C7] Client called nw_connection_copy_protocol_metadata_internal on unconnected nw_connection
nw_connection_copy_connected_local_endpoint_block_invoke [C11] Client called nw_connection_copy_connected_local_endpoint on unconnected nw_connection
nw_connection_copy_connected_remote_endpoint_block_invoke [C11] Client called nw_connection_copy_connected_remote_endpoint on unconnected nw_connection
nw_connection_copy_protocol_metadata_internal_block_invoke [C11] Client called nw_connection_copy_protocol_metadata_internal on unconnected nw_connection
nw_connection_copy_connected_local_endpoint_block_invoke [C12] Client called nw_connection_copy_connected_local_endpoint on unconnected nw_connection
nw_connection_copy_connected_remote_endpoint_block_invoke [C12] Client called nw_connection_copy_connected_remote_endpoint on unconnected nw_connection
nw_connection_copy_protocol_metadata_internal_block_invoke [C12] Client called nw_connection_copy_protocol_metadata_internal on unconnected nw_connection
✅ Fetched 6 routes
✅ After distance filtering: 6 routes
📍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2, type: Single, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: x8gtPvzh0v8lHICTMc6v, name: Test, type: Event, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: lSP87JlykN0waqNgD0l3, name: The Otway Rip, type: Bikepacking, distance: 256.8km
📍 Has coordinates: lat=-38.22902, lng=143.150573
📍 Route: mPzC8y2chmMrVneOoB9o, name: Erskine Falls, type: Single, distance: 29.3km
📍 Has coordinates: lat=-38.54869, lng=143.95843
📍 Route: gmRh8B6akTWQcPG6WucU, name: Gariwerd Explorer (Grampians NP), type: Bikepacking, distance: 293.9km
📍 Has coordinates: lat=-37.28415, lng=142.93575
📍 Route: NPm5zoKKnHCqE8NKHfbt, name: NZ Sth Island Trail Mix, type: Bikepacking, distance: 632.3km
📍 Has coordinates: lat=-43.858329, lng=170.174423
✅ Updated routes in view model
🔄 viewModel.routes changed, updating displayedRouteMarkers with 6 routes
🗺️ Getting route markers for map display
🔍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 147.32879, lat: -41.36721))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-41.36721, lng=147.32879
🔍 clCoordinate values: lat=-41.36721, lng=147.32879
🔍 Route: x8gtPvzh0v8lHICTMc6v, name: Test
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 147.32879, lat: -41.36721))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-41.36721, lng=147.32879
🔍 clCoordinate values: lat=-41.36721, lng=147.32879
🔍 Route: lSP87JlykN0waqNgD0l3, name: The Otway Rip
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 143.150573, lat: -38.22902))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-38.22902, lng=143.150573
🔍 clCoordinate values: lat=-38.22902, lng=143.150573
🔍 Route: mPzC8y2chmMrVneOoB9o, name: Erskine Falls
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 143.95843, lat: -38.54869))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-38.54869, lng=143.95843
🔍 clCoordinate values: lat=-38.54869, lng=143.95843
🔍 Route: gmRh8B6akTWQcPG6WucU, name: Gariwerd Explorer (Grampians NP)
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 142.93575, lat: -37.28415))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-37.28415, lng=142.93575
🔍 clCoordinate values: lat=-37.28415, lng=142.93575
🔍 Route: NPm5zoKKnHCqE8NKHfbt, name: NZ Sth Island Trail Mix
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 170.174423, lat: -43.858329))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-43.858329, lng=170.174423
🔍 clCoordinate values: lat=-43.858329, lng=170.174423
🗺️ Created 6 markers from 6 routes for HomeView map
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🔍 Route zj3GELVpT8M3ghIs8UI6: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route zj3GELVpT8M3ghIs8UI6 (type: Single). Image size: (32.0, 32.0)
🔍 Route x8gtPvzh0v8lHICTMc6v: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Event, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route x8gtPvzh0v8lHICTMc6v (type: Event). Image size: (32.0, 32.0)
🔍 Route lSP87JlykN0waqNgD0l3: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route lSP87JlykN0waqNgD0l3 (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route mPzC8y2chmMrVneOoB9o: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route mPzC8y2chmMrVneOoB9o (type: Single). Image size: (32.0, 32.0)
🔍 Route gmRh8B6akTWQcPG6WucU: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route gmRh8B6akTWQcPG6WucU (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route NPm5zoKKnHCqE8NKHfbt: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route NPm5zoKKnHCqE8NKHfbt (type: Bikepacking). Image size: (32.0, 32.0)
🎯 RouteTypeMarker: Assigned 6 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 6
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 0 styled routes. Unpaved drawn for: 0 routes.
✅ Fetched 6 routes
✅ After distance filtering: 6 routes
📍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2, type: Single, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: x8gtPvzh0v8lHICTMc6v, name: Test, type: Event, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: lSP87JlykN0waqNgD0l3, name: The Otway Rip, type: Bikepacking, distance: 256.8km
📍 Has coordinates: lat=-38.22902, lng=143.150573
📍 Route: mPzC8y2chmMrVneOoB9o, name: Erskine Falls, type: Single, distance: 29.3km
📍 Has coordinates: lat=-38.54869, lng=143.95843
📍 Route: gmRh8B6akTWQcPG6WucU, name: Gariwerd Explorer (Grampians NP), type: Bikepacking, distance: 293.9km
📍 Has coordinates: lat=-37.28415, lng=142.93575
📍 Route: NPm5zoKKnHCqE8NKHfbt, name: NZ Sth Island Trail Mix, type: Bikepacking, distance: 632.3km
📍 Has coordinates: lat=-43.858329, lng=170.174423
✅ Updated routes in view model
✅ Fetched 6 routes
✅ After distance filtering: 6 routes
📍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2, type: Single, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: x8gtPvzh0v8lHICTMc6v, name: Test, type: Event, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: lSP87JlykN0waqNgD0l3, name: The Otway Rip, type: Bikepacking, distance: 256.8km
📍 Has coordinates: lat=-38.22902, lng=143.150573
📍 Route: mPzC8y2chmMrVneOoB9o, name: Erskine Falls, type: Single, distance: 29.3km
📍 Has coordinates: lat=-38.54869, lng=143.95843
📍 Route: gmRh8B6akTWQcPG6WucU, name: Gariwerd Explorer (Grampians NP), type: Bikepacking, distance: 293.9km
📍 Has coordinates: lat=-37.28415, lng=142.93575
📍 Route: NPm5zoKKnHCqE8NKHfbt, name: NZ Sth Island Trail Mix, type: Bikepacking, distance: 632.3km
📍 Has coordinates: lat=-43.858329, lng=170.174423
✅ Updated routes in view model
✅ Fetched 6 routes
✅ After distance filtering: 6 routes
📍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2, type: Single, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: x8gtPvzh0v8lHICTMc6v, name: Test, type: Event, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: lSP87JlykN0waqNgD0l3, name: The Otway Rip, type: Bikepacking, distance: 256.8km
📍 Has coordinates: lat=-38.22902, lng=143.150573
📍 Route: mPzC8y2chmMrVneOoB9o, name: Erskine Falls, type: Single, distance: 29.3km
📍 Has coordinates: lat=-38.54869, lng=143.95843
📍 Route: gmRh8B6akTWQcPG6WucU, name: Gariwerd Explorer (Grampians NP), type: Bikepacking, distance: 293.9km
📍 Has coordinates: lat=-37.28415, lng=142.93575
📍 Route: NPm5zoKKnHCqE8NKHfbt, name: NZ Sth Island Trail Mix, type: Bikepacking, distance: 632.3km
📍 Has coordinates: lat=-43.858329, lng=170.174423
✅ Updated routes in view model
✅ Fetched 6 routes
✅ After distance filtering: 6 routes
📍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2, type: Single, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: x8gtPvzh0v8lHICTMc6v, name: Test, type: Event, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: lSP87JlykN0waqNgD0l3, name: The Otway Rip, type: Bikepacking, distance: 256.8km
📍 Has coordinates: lat=-38.22902, lng=143.150573
📍 Route: mPzC8y2chmMrVneOoB9o, name: Erskine Falls, type: Single, distance: 29.3km
📍 Has coordinates: lat=-38.54869, lng=143.95843
📍 Route: gmRh8B6akTWQcPG6WucU, name: Gariwerd Explorer (Grampians NP), type: Bikepacking, distance: 293.9km
📍 Has coordinates: lat=-37.28415, lng=142.93575
📍 Route: NPm5zoKKnHCqE8NKHfbt, name: NZ Sth Island Trail Mix, type: Bikepacking, distance: 632.3km
📍 Has coordinates: lat=-43.858329, lng=170.174423
✅ Updated routes in view model
👆 [LAYER_TAP] Layer tap detected on home-map-start-end-point-manager
👆 [LAYER_TAP] Feature ID: zj3GELVpT8M3ghIs8UI6
👆 [LAYER_TAP] Feature properties: ["custom_data": Optional(Turf.JSONValue.object(["routeId": Optional(Turf.JSONValue.string("zj3GELVpT8M3ghIs8UI6")), "name": Optional(Turf.JSONValue.string("Test 2"))])), "layerProperties": Optional(Turf.JSONValue.object(["icon-anchor": Optional(Turf.JSONValue.string("center")), "icon-image": Optional(Turf.JSONValue.string("route-type-marker-zj3GELVpT8M3ghIs8UI6"))]))]
👆 [LAYER_TAP] Found route ID from feature ID: zj3GELVpT8M3ghIs8UI6
👆 [LAYER_TAP] Posting notification with coordinate: (-41.367, 147.329)
📱 [MARKER_TAP] Received notification for tapped route: zj3GELVpT8M3ghIs8UI6
📱 [MARKER_TAP] Notification userInfo: [AnyHashable("routeId"): "zj3GELVpT8M3ghIs8UI6", AnyHashable("coordinate"): (-41.367, 147.329)]
📱 [MARKER_TAP] Found route: Test 2
📱 [MARKER_TAP] Using coordinate from notification: (-41.367, 147.329)
📱 [MARKER_TAP] Setting isMarkerInteraction = true to prevent region camera changes
Publishing changes from background threads is not allowed; make sure to publish values from the main thread (via operators like receive(on:)) on model updates.
Publishing changes from background threads is not allowed; make sure to publish values from the main thread (via operators like receive(on:)) on model updates.
Publishing changes from background threads is not allowed; make sure to publish values from the main thread (via operators like receive(on:)) on model updates.
Publishing changes from background threads is not allowed; make sure to publish values from the main thread (via operators like receive(on:)) on model updates.
📱 [MARKER_TAP] Loading full route coordinates for zj3GELVpT8M3ghIs8UI6
🔄 Loading full route coordinates for route: zj3GELVpT8M3ghIs8UI6
✅ Found 1 route segments
🔍 Processing segment with routeId: route-955ee5f7-4b8c-4710-a04a-f38fe2307395
✅ Found 129 coordinates for segment route-955ee5f7-4b8c-4710-a04a-f38fe2307395
✅ Loaded 1 coordinate segments for route zj3GELVpT8M3ghIs8UI6
✅ Updated route zj3GELVpT8M3ghIs8UI6 with 1 coordinate segments
🔄 viewModel.routes changed, updating displayedRouteMarkers with 6 routes
🗺️ Getting route markers for map display
🔍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 147.32879, lat: -41.36721))
🔍 routeCoordinates count: 1
🔍 startCoordinate values: lat=-41.36721, lng=147.32879
🔍 clCoordinate values: lat=-41.36721, lng=147.32879
🔍 Route: x8gtPvzh0v8lHICTMc6v, name: Test
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 147.32879, lat: -41.36721))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-41.36721, lng=147.32879
🔍 clCoordinate values: lat=-41.36721, lng=147.32879
🔍 Route: lSP87JlykN0waqNgD0l3, name: The Otway Rip
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 143.150573, lat: -38.22902))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-38.22902, lng=143.150573
🔍 clCoordinate values: lat=-38.22902, lng=143.150573
🔍 Route: mPzC8y2chmMrVneOoB9o, name: Erskine Falls
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 143.95843, lat: -38.54869))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-38.54869, lng=143.95843
🔍 clCoordinate values: lat=-38.54869, lng=143.95843
🔍 Route: gmRh8B6akTWQcPG6WucU, name: Gariwerd Explorer (Grampians NP)
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 142.93575, lat: -37.28415))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-37.28415, lng=142.93575
🔍 clCoordinate values: lat=-37.28415, lng=142.93575
🔍 Route: NPm5zoKKnHCqE8NKHfbt, name: NZ Sth Island Trail Mix
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 170.174423, lat: -43.858329))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-43.858329, lng=170.174423
🔍 clCoordinate values: lat=-43.858329, lng=170.174423
🗺️ Created 6 markers from 6 routes for HomeView map
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🔍 Route zj3GELVpT8M3ghIs8UI6: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route zj3GELVpT8M3ghIs8UI6 (type: Single). Image size: (32.0, 32.0)
🔍 Found 1 unpaved sections to display on map for route: Test 2
🗺️ Processing unpaved section 1 for route Test 2 with 75 explicit coordinates
✅ UNPAVED: Executing addLayersAction immediately for route Test 2
✅ UNPAVED: Executing addLayersAction for 1 features for route: Test 2
🔍 UNPAVED: Converting 1 GeoJSON features to 1 Turf features for route: Test 2
✅ Source 'unpaved-source-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
✅ Layer 'unpaved-layer-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
🗺️ Added 1 unpaved sections to the map for route: Test 2
🔍 Route x8gtPvzh0v8lHICTMc6v: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Event, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route x8gtPvzh0v8lHICTMc6v (type: Event). Image size: (32.0, 32.0)
🔍 Route lSP87JlykN0waqNgD0l3: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route lSP87JlykN0waqNgD0l3 (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route mPzC8y2chmMrVneOoB9o: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route mPzC8y2chmMrVneOoB9o (type: Single). Image size: (32.0, 32.0)
🔍 Route gmRh8B6akTWQcPG6WucU: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route gmRh8B6akTWQcPG6WucU (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route NPm5zoKKnHCqE8NKHfbt: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route NPm5zoKKnHCqE8NKHfbt (type: Bikepacking). Image size: (32.0, 32.0)
🎯 RouteTypeMarker: Assigned 6 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 6
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 1 styled routes. Unpaved drawn for: 1 routes.
📱 [MARKER_TAP] Calling centerCameraOnMarker with coordinate: (-41.367, 147.329)
🎯 [CAMERA_POI_STYLE] Using EXACT same approach as working POI markers
🎯 [CAMERA_POI_STYLE] Setting cameraPosition like POI markers do
🎬 [CAMERA_ASSIGNMENT] Setting camera from MARKER TAP
🎯 [CAMERA_POI_STYLE] Done - should work like POI markers
📱 [MARKER_TAP] Setting isMarkerInteraction = false to re-enable region camera changes
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🔍 Route zj3GELVpT8M3ghIs8UI6: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route zj3GELVpT8M3ghIs8UI6 (type: Single). Image size: (32.0, 32.0)
🔍 Found 1 unpaved sections to display on map for route: Test 2
🗺️ Processing unpaved section 1 for route Test 2 with 75 explicit coordinates
✅ UNPAVED: Executing addLayersAction immediately for route Test 2
✅ UNPAVED: Executing addLayersAction for 1 features for route: Test 2
🔍 UNPAVED: Converting 1 GeoJSON features to 1 Turf features for route: Test 2
✅ Source 'unpaved-source-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
✅ Layer 'unpaved-layer-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
🗺️ Added 1 unpaved sections to the map for route: Test 2
🔍 Route x8gtPvzh0v8lHICTMc6v: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Event, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route x8gtPvzh0v8lHICTMc6v (type: Event). Image size: (32.0, 32.0)
🔍 Route lSP87JlykN0waqNgD0l3: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route lSP87JlykN0waqNgD0l3 (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route mPzC8y2chmMrVneOoB9o: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route mPzC8y2chmMrVneOoB9o (type: Single). Image size: (32.0, 32.0)
🔍 Route gmRh8B6akTWQcPG6WucU: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route gmRh8B6akTWQcPG6WucU (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route NPm5zoKKnHCqE8NKHfbt: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route NPm5zoKKnHCqE8NKHfbt (type: Bikepacking). Image size: (32.0, 32.0)
🎯 RouteTypeMarker: Assigned 6 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 6
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 1 styled routes. Unpaved drawn for: 1 routes.
[Info, tile_store]: Searching for stray files to clean up
[Info, tile_store]: Cleanup of stray partial downloads complete
[Info, tile_store]: Searching for stale partial downloads to clean up
[Info, tile_store]: Cleanup of stray partial downloads complete
🗺️ Resetting camera to country region: Australia
🗺️ State region changed to: Tasmania. Updating camera.
🎬 [CAMERA_ASSIGNMENT] Setting camera from STATE REGION CHANGE
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🔍 Route zj3GELVpT8M3ghIs8UI6: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route zj3GELVpT8M3ghIs8UI6 (type: Single). Image size: (32.0, 32.0)
🔍 Found 1 unpaved sections to display on map for route: Test 2
🗺️ Processing unpaved section 1 for route Test 2 with 75 explicit coordinates
✅ UNPAVED: Executing addLayersAction immediately for route Test 2
✅ UNPAVED: Executing addLayersAction for 1 features for route: Test 2
🔍 UNPAVED: Converting 1 GeoJSON features to 1 Turf features for route: Test 2
✅ Source 'unpaved-source-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
✅ Layer 'unpaved-layer-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
🗺️ Added 1 unpaved sections to the map for route: Test 2
🔍 Route x8gtPvzh0v8lHICTMc6v: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Event, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route x8gtPvzh0v8lHICTMc6v (type: Event). Image size: (32.0, 32.0)
🔍 Route lSP87JlykN0waqNgD0l3: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route lSP87JlykN0waqNgD0l3 (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route mPzC8y2chmMrVneOoB9o: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route mPzC8y2chmMrVneOoB9o (type: Single). Image size: (32.0, 32.0)
🔍 Route gmRh8B6akTWQcPG6WucU: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route gmRh8B6akTWQcPG6WucU (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route NPm5zoKKnHCqE8NKHfbt: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route NPm5zoKKnHCqE8NKHfbt (type: Bikepacking). Image size: (32.0, 32.0)
🎯 RouteTypeMarker: Assigned 6 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 6
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 1 styled routes. Unpaved drawn for: 1 routes.
🔄 Loading routes with filters
🔄 Filter - country: Australia
🔄 Filter - state: TAS
🔄 Client-side filter - minimum distance: 0.0
🔄 Fetching routes from Firebase...
🔍 Fetching routes with filters: Optional(["state": "TAS", "isPublic": true, "country": "Australia"])
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🔍 Route zj3GELVpT8M3ghIs8UI6: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route zj3GELVpT8M3ghIs8UI6 (type: Single). Image size: (32.0, 32.0)
🔍 Found 1 unpaved sections to display on map for route: Test 2
🗺️ Processing unpaved section 1 for route Test 2 with 75 explicit coordinates
✅ UNPAVED: Executing addLayersAction immediately for route Test 2
✅ UNPAVED: Executing addLayersAction for 1 features for route: Test 2
🔍 UNPAVED: Converting 1 GeoJSON features to 1 Turf features for route: Test 2
✅ Source 'unpaved-source-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
✅ Layer 'unpaved-layer-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
🗺️ Added 1 unpaved sections to the map for route: Test 2
🔍 Route x8gtPvzh0v8lHICTMc6v: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Event, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route x8gtPvzh0v8lHICTMc6v (type: Event). Image size: (32.0, 32.0)
🔍 Route lSP87JlykN0waqNgD0l3: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route lSP87JlykN0waqNgD0l3 (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route mPzC8y2chmMrVneOoB9o: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route mPzC8y2chmMrVneOoB9o (type: Single). Image size: (32.0, 32.0)
🔍 Route gmRh8B6akTWQcPG6WucU: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route gmRh8B6akTWQcPG6WucU (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route NPm5zoKKnHCqE8NKHfbt: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route NPm5zoKKnHCqE8NKHfbt (type: Bikepacking). Image size: (32.0, 32.0)
🎯 RouteTypeMarker: Assigned 6 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 6
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 1 styled routes. Unpaved drawn for: 1 routes.
🔍 Route zj3GELVpT8M3ghIs8UI6 matches state filter: states ["Tasmania"] contain 'TAS' or 'Tasmania'
🔍 Route x8gtPvzh0v8lHICTMc6v matches state filter: states ["Tasmania"] contain 'TAS' or 'Tasmania'
🔍 Skipping route lSP87JlykN0waqNgD0l3: states ["Victoria"] don't match requested 'TAS' or 'Tasmania'
🔍 Skipping route mPzC8y2chmMrVneOoB9o: states ["Victoria"] don't match requested 'TAS' or 'Tasmania'
🔍 Skipping route gmRh8B6akTWQcPG6WucU: states ["Victoria"] don't match requested 'TAS' or 'Tasmania'
🔍 Skipping route NPm5zoKKnHCqE8NKHfbt: states ["Canterbury", "Otago"] don't match requested 'TAS' or 'Tasmania'
✅ Fetched 2 routes
✅ After distance filtering: 2 routes
📍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2, type: Single, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: x8gtPvzh0v8lHICTMc6v, name: Test, type: Event, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
✅ Updated routes in view model
🔄 viewModel.routes changed, updating displayedRouteMarkers with 2 routes
🗺️ Getting route markers for map display
🔍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 147.32879, lat: -41.36721))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-41.36721, lng=147.32879
🔍 clCoordinate values: lat=-41.36721, lng=147.32879
🔍 Route: x8gtPvzh0v8lHICTMc6v, name: Test
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 147.32879, lat: -41.36721))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-41.36721, lng=147.32879
🔍 clCoordinate values: lat=-41.36721, lng=147.32879
🗺️ Created 2 markers from 2 routes for HomeView map
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🔍 Route zj3GELVpT8M3ghIs8UI6: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route zj3GELVpT8M3ghIs8UI6 (type: Single). Image size: (32.0, 32.0)
🔍 Route x8gtPvzh0v8lHICTMc6v: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Event, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route x8gtPvzh0v8lHICTMc6v (type: Event). Image size: (32.0, 32.0)
🎯 RouteTypeMarker: Assigned 2 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 2
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 0 styled routes. Unpaved drawn for: 0 routes.
[Warning, maps-core]: {}[Style]: Required image 'route-type-marker-gmRh8B6akTWQcPG6WucU' is missing and it will not be rendered. Subscribe to StyleImageMissing event to be aware of the required missing images and add them by calling addStyleImage().
[Warning, maps-core]: {}[Style]: Required image 'route-type-marker-mPzC8y2chmMrVneOoB9o' is missing and it will not be rendered. Subscribe to StyleImageMissing event to be aware of the required missing images and add them by calling addStyleImage().
[Warning, maps-core]: {}[Style]: Required image 'route-type-marker-lSP87JlykN0waqNgD0l3' is missing and it will not be rendered. Subscribe to StyleImageMissing event to be aware of the required missing images and add them by calling addStyleImage().
[Warning, maps-core]: {}[Style]: Required image 'route-type-marker-NPm5zoKKnHCqE8NKHfbt' is missing and it will not be rendered. Subscribe to StyleImageMissing event to be aware of the required missing images and add them by calling addStyleImage().
🔄 Loading routes with filters
🔄 Filter - country: Australia
🔄 Filter - state: TAS
🔄 Client-side filter - minimum distance: 0.0
🔄 Fetching routes from Firebase...
🔍 Fetching routes with filters: Optional(["isPublic": true, "state": "TAS", "country": "Australia"])
🔍 Route zj3GELVpT8M3ghIs8UI6 matches state filter: states ["Tasmania"] contain 'TAS' or 'Tasmania'
🔍 Route x8gtPvzh0v8lHICTMc6v matches state filter: states ["Tasmania"] contain 'TAS' or 'Tasmania'
🗺️ State region cleared. Reverting to country: Australia.
🎬 [CAMERA_ASSIGNMENT] Setting camera from STATE REGION CLEARED
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🔍 Route zj3GELVpT8M3ghIs8UI6: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route zj3GELVpT8M3ghIs8UI6 (type: Single). Image size: (32.0, 32.0)
🔍 Route x8gtPvzh0v8lHICTMc6v: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Event, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route x8gtPvzh0v8lHICTMc6v (type: Event). Image size: (32.0, 32.0)
🎯 RouteTypeMarker: Assigned 2 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 2
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 0 styled routes. Unpaved drawn for: 0 routes.
🔍 Skipping route lSP87JlykN0waqNgD0l3: states ["Victoria"] don't match requested 'TAS' or 'Tasmania'
🔍 Skipping route mPzC8y2chmMrVneOoB9o: states ["Victoria"] don't match requested 'TAS' or 'Tasmania'
🔍 Skipping route gmRh8B6akTWQcPG6WucU: states ["Victoria"] don't match requested 'TAS' or 'Tasmania'
🔍 Skipping route NPm5zoKKnHCqE8NKHfbt: states ["Canterbury", "Otago"] don't match requested 'TAS' or 'Tasmania'
✅ Fetched 2 routes
✅ After distance filtering: 2 routes
📍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2, type: Single, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: x8gtPvzh0v8lHICTMc6v, name: Test, type: Event, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
✅ Updated routes in view model
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🔍 Route zj3GELVpT8M3ghIs8UI6: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route zj3GELVpT8M3ghIs8UI6 (type: Single). Image size: (32.0, 32.0)
🔍 Route x8gtPvzh0v8lHICTMc6v: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Event, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route x8gtPvzh0v8lHICTMc6v (type: Event). Image size: (32.0, 32.0)
🎯 RouteTypeMarker: Assigned 2 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 2
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 0 styled routes. Unpaved drawn for: 0 routes.
🔄 Updated available states for Australia: ["TAS", "VIC", "NSW", "QLD", "SA", "WA", "NT", "ACT"]
🔄 Loading routes with filters
🔄 Filter - country: Australia
🔄 Client-side filter - minimum distance: 0.0
🔄 Fetching routes from Firebase...
🔍 Fetching routes with filters: Optional(["isPublic": true, "country": "Australia"])
🔄 Loading routes with filters
🔄 Filter - country: Australia
🔄 Client-side filter - minimum distance: 0.0
🔄 Fetching routes from Firebase...
🔍 Fetching routes with filters: Optional(["isPublic": true, "country": "Australia"])
✅ Fetched 6 routes
✅ After distance filtering: 6 routes
📍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2, type: Single, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: x8gtPvzh0v8lHICTMc6v, name: Test, type: Event, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: lSP87JlykN0waqNgD0l3, name: The Otway Rip, type: Bikepacking, distance: 256.8km
📍 Has coordinates: lat=-38.22902, lng=143.150573
📍 Route: mPzC8y2chmMrVneOoB9o, name: Erskine Falls, type: Single, distance: 29.3km
📍 Has coordinates: lat=-38.54869, lng=143.95843
📍 Route: gmRh8B6akTWQcPG6WucU, name: Gariwerd Explorer (Grampians NP), type: Bikepacking, distance: 293.9km
📍 Has coordinates: lat=-37.28415, lng=142.93575
📍 Route: NPm5zoKKnHCqE8NKHfbt, name: NZ Sth Island Trail Mix, type: Bikepacking, distance: 632.3km
📍 Has coordinates: lat=-43.858329, lng=170.174423
✅ Updated routes in view model
🔄 viewModel.routes changed, updating displayedRouteMarkers with 6 routes
🗺️ Getting route markers for map display
🔍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 147.32879, lat: -41.36721))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-41.36721, lng=147.32879
🔍 clCoordinate values: lat=-41.36721, lng=147.32879
🔍 Route: x8gtPvzh0v8lHICTMc6v, name: Test
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 147.32879, lat: -41.36721))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-41.36721, lng=147.32879
🔍 clCoordinate values: lat=-41.36721, lng=147.32879
🔍 Route: lSP87JlykN0waqNgD0l3, name: The Otway Rip
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 143.150573, lat: -38.22902))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-38.22902, lng=143.150573
🔍 clCoordinate values: lat=-38.22902, lng=143.150573
🔍 Route: mPzC8y2chmMrVneOoB9o, name: Erskine Falls
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 143.95843, lat: -38.54869))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-38.54869, lng=143.95843
🔍 clCoordinate values: lat=-38.54869, lng=143.95843
🔍 Route: gmRh8B6akTWQcPG6WucU, name: Gariwerd Explorer (Grampians NP)
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 142.93575, lat: -37.28415))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-37.28415, lng=142.93575
🔍 clCoordinate values: lat=-37.28415, lng=142.93575
🔍 Route: NPm5zoKKnHCqE8NKHfbt, name: NZ Sth Island Trail Mix
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 170.174423, lat: -43.858329))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-43.858329, lng=170.174423
🔍 clCoordinate values: lat=-43.858329, lng=170.174423
🗺️ Created 6 markers from 6 routes for HomeView map
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🔍 Route zj3GELVpT8M3ghIs8UI6: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route zj3GELVpT8M3ghIs8UI6 (type: Single). Image size: (32.0, 32.0)
🔍 Route x8gtPvzh0v8lHICTMc6v: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Event, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route x8gtPvzh0v8lHICTMc6v (type: Event). Image size: (32.0, 32.0)
🔍 Route lSP87JlykN0waqNgD0l3: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route lSP87JlykN0waqNgD0l3 (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route mPzC8y2chmMrVneOoB9o: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route mPzC8y2chmMrVneOoB9o (type: Single). Image size: (32.0, 32.0)
🔍 Route gmRh8B6akTWQcPG6WucU: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route gmRh8B6akTWQcPG6WucU (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route NPm5zoKKnHCqE8NKHfbt: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route NPm5zoKKnHCqE8NKHfbt (type: Bikepacking). Image size: (32.0, 32.0)
🎯 RouteTypeMarker: Assigned 6 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 6
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 0 styled routes. Unpaved drawn for: 0 routes.
✅ Fetched 6 routes
✅ After distance filtering: 6 routes
📍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2, type: Single, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: x8gtPvzh0v8lHICTMc6v, name: Test, type: Event, distance: 7.3km
📍 Has coordinates: lat=-41.36721, lng=147.32879
📍 Route: lSP87JlykN0waqNgD0l3, name: The Otway Rip, type: Bikepacking, distance: 256.8km
📍 Has coordinates: lat=-38.22902, lng=143.150573
📍 Route: mPzC8y2chmMrVneOoB9o, name: Erskine Falls, type: Single, distance: 29.3km
📍 Has coordinates: lat=-38.54869, lng=143.95843
📍 Route: gmRh8B6akTWQcPG6WucU, name: Gariwerd Explorer (Grampians NP), type: Bikepacking, distance: 293.9km
📍 Has coordinates: lat=-37.28415, lng=142.93575
📍 Route: NPm5zoKKnHCqE8NKHfbt, name: NZ Sth Island Trail Mix, type: Bikepacking, distance: 632.3km
📍 Has coordinates: lat=-43.858329, lng=170.174423
✅ Updated routes in view model
👆 [GENERAL_TAP] Map tapped at coordinate: (-43.769, 145.477)
👆 [LAYER_TAP] Layer tap detected on home-map-start-end-point-manager
👆 [LAYER_TAP] Feature ID: zj3GELVpT8M3ghIs8UI6
👆 [LAYER_TAP] Feature properties: ["layerProperties": Optional(Turf.JSONValue.object(["icon-anchor": Optional(Turf.JSONValue.string("center")), "icon-image": Optional(Turf.JSONValue.string("route-type-marker-zj3GELVpT8M3ghIs8UI6"))])), "custom_data": Optional(Turf.JSONValue.object(["routeId": Optional(Turf.JSONValue.string("zj3GELVpT8M3ghIs8UI6")), "name": Optional(Turf.JSONValue.string("Test 2"))]))]
👆 [LAYER_TAP] Found route ID from feature ID: zj3GELVpT8M3ghIs8UI6
👆 [LAYER_TAP] Posting notification with coordinate: (-41.367, 147.329)
📱 [MARKER_TAP] Received notification for tapped route: zj3GELVpT8M3ghIs8UI6
📱 [MARKER_TAP] Notification userInfo: [AnyHashable("routeId"): "zj3GELVpT8M3ghIs8UI6", AnyHashable("coordinate"): (-41.367, 147.329)]
📱 [MARKER_TAP] Found route: Test 2
📱 [MARKER_TAP] Using coordinate from notification: (-41.367, 147.329)
📱 [MARKER_TAP] Setting isMarkerInteraction = true to prevent region camera changes
Publishing changes from background threads is not allowed; make sure to publish values from the main thread (via operators like receive(on:)) on model updates.
Publishing changes from background threads is not allowed; make sure to publish values from the main thread (via operators like receive(on:)) on model updates.
Publishing changes from background threads is not allowed; make sure to publish values from the main thread (via operators like receive(on:)) on model updates.
Publishing changes from background threads is not allowed; make sure to publish values from the main thread (via operators like receive(on:)) on model updates.
📱 [MARKER_TAP] Loading full route coordinates for zj3GELVpT8M3ghIs8UI6
🔄 Loading full route coordinates for route: zj3GELVpT8M3ghIs8UI6
✅ Found 1 route segments
🔍 Processing segment with routeId: route-955ee5f7-4b8c-4710-a04a-f38fe2307395
✅ Found 129 coordinates for segment route-955ee5f7-4b8c-4710-a04a-f38fe2307395
✅ Loaded 1 coordinate segments for route zj3GELVpT8M3ghIs8UI6
✅ Updated route zj3GELVpT8M3ghIs8UI6 with 1 coordinate segments
🔄 viewModel.routes changed, updating displayedRouteMarkers with 6 routes
🗺️ Getting route markers for map display
🔍 Route: zj3GELVpT8M3ghIs8UI6, name: Test 2
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 147.32879, lat: -41.36721))
🔍 routeCoordinates count: 1
🔍 startCoordinate values: lat=-41.36721, lng=147.32879
🔍 clCoordinate values: lat=-41.36721, lng=147.32879
🔍 Route: x8gtPvzh0v8lHICTMc6v, name: Test
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 147.32879, lat: -41.36721))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-41.36721, lng=147.32879
🔍 clCoordinate values: lat=-41.36721, lng=147.32879
🔍 Route: lSP87JlykN0waqNgD0l3, name: The Otway Rip
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 143.150573, lat: -38.22902))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-38.22902, lng=143.150573
🔍 clCoordinate values: lat=-38.22902, lng=143.150573
🔍 Route: mPzC8y2chmMrVneOoB9o, name: Erskine Falls
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 143.95843, lat: -38.54869))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-38.54869, lng=143.95843
🔍 clCoordinate values: lat=-38.54869, lng=143.95843
🔍 Route: gmRh8B6akTWQcPG6WucU, name: Gariwerd Explorer (Grampians NP)
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 142.93575, lat: -37.28415))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-37.28415, lng=142.93575
🔍 clCoordinate values: lat=-37.28415, lng=142.93575
🔍 Route: NPm5zoKKnHCqE8NKHfbt, name: NZ Sth Island Trail Mix
🔍 startCoordinate: Optional(CyaTrails.Coordinates(lng: 170.174423, lat: -43.858329))
🔍 routeCoordinates count: 0
🔍 startCoordinate values: lat=-43.858329, lng=170.174423
🔍 clCoordinate values: lat=-43.858329, lng=170.174423
🗺️ Created 6 markers from 6 routes for HomeView map
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🔍 Route zj3GELVpT8M3ghIs8UI6: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route zj3GELVpT8M3ghIs8UI6 (type: Single). Image size: (32.0, 32.0)
🔍 Found 1 unpaved sections to display on map for route: Test 2
🗺️ Processing unpaved section 1 for route Test 2 with 75 explicit coordinates
✅ UNPAVED: Executing addLayersAction immediately for route Test 2
✅ UNPAVED: Executing addLayersAction for 1 features for route: Test 2
🔍 UNPAVED: Converting 1 GeoJSON features to 1 Turf features for route: Test 2
✅ Source 'unpaved-source-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
✅ Layer 'unpaved-layer-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
🗺️ Added 1 unpaved sections to the map for route: Test 2
🔍 Route x8gtPvzh0v8lHICTMc6v: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Event, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route x8gtPvzh0v8lHICTMc6v (type: Event). Image size: (32.0, 32.0)
🔍 Route lSP87JlykN0waqNgD0l3: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route lSP87JlykN0waqNgD0l3 (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route mPzC8y2chmMrVneOoB9o: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route mPzC8y2chmMrVneOoB9o (type: Single). Image size: (32.0, 32.0)
🔍 Route gmRh8B6akTWQcPG6WucU: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route gmRh8B6akTWQcPG6WucU (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route NPm5zoKKnHCqE8NKHfbt: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route NPm5zoKKnHCqE8NKHfbt (type: Bikepacking). Image size: (32.0, 32.0)
🎯 RouteTypeMarker: Assigned 6 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 6
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 1 styled routes. Unpaved drawn for: 1 routes.
📱 [MARKER_TAP] Calling centerCameraOnMarker with coordinate: (-41.367, 147.329)
🎯 [CAMERA_POI_STYLE] Using EXACT same approach as working POI markers
🎯 [CAMERA_POI_STYLE] Setting cameraPosition like POI markers do
🎬 [CAMERA_ASSIGNMENT] Setting camera from MARKER TAP
🎯 [CAMERA_POI_STYLE] Done - should work like POI markers
📱 [MARKER_TAP] Setting isMarkerInteraction = false to re-enable region camera changes
🎬 HomeView: Easing camera to new position like EnhancedRouteMapView
🔍 Route zj3GELVpT8M3ghIs8UI6: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route zj3GELVpT8M3ghIs8UI6 (type: Single). Image size: (32.0, 32.0)
🔍 Found 1 unpaved sections to display on map for route: Test 2
🗺️ Processing unpaved section 1 for route Test 2 with 75 explicit coordinates
✅ UNPAVED: Executing addLayersAction immediately for route Test 2
✅ UNPAVED: Executing addLayersAction for 1 features for route: Test 2
🔍 UNPAVED: Converting 1 GeoJSON features to 1 Turf features for route: Test 2
✅ Source 'unpaved-source-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
✅ Layer 'unpaved-layer-zj3GELVpT8M3ghIs8UI6' added successfully for route: Test 2
🗺️ Added 1 unpaved sections to the map for route: Test 2
🔍 Route x8gtPvzh0v8lHICTMc6v: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Event, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route x8gtPvzh0v8lHICTMc6v (type: Event). Image size: (32.0, 32.0)
🔍 Route lSP87JlykN0waqNgD0l3: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route lSP87JlykN0waqNgD0l3 (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route mPzC8y2chmMrVneOoB9o: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Single, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route mPzC8y2chmMrVneOoB9o (type: Single). Image size: (32.0, 32.0)
🔍 Route gmRh8B6akTWQcPG6WucU: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route gmRh8B6akTWQcPG6WucU (type: Bikepacking). Image size: (32.0, 32.0)
🔍 Route NPm5zoKKnHCqE8NKHfbt: selectedRouteId=nil, isSelected=false
🎯 Creating marker for Bikepacking, isSelected: false, iconColor: white
🎯 RouteTypeMarker: Successfully rendered image for route NPm5zoKKnHCqE8NKHfbt (type: Bikepacking). Image size: (32.0, 32.0)
🎯 RouteTypeMarker: Assigned 6 point annotations to manager.
🎯 [TAP_SETUP] Setting up layer tap handler for layer: home-map-start-end-point-manager
🎯 [TAP_SETUP] Manager exists: MapboxMaps.PointAnnotationManager, annotations count: 6
🎯 [TAP_SETUP] Style loaded: true
🗺️ Updated HomeView map with 1 styled routes. Unpaved drawn for: 1 routes.